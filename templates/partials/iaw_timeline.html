<!-- =====================================================
     IAW — INCIDENT TIMELINE (EMBEDDED PARTIAL)
     Unified: Narrative + IncidentHistory + Photos
===================================================== -->

<div class="iaw-timeline">

    {% if timeline|length == 0 %}
        <div class="iaw-empty">No timeline events recorded.</div>
    {% endif %}

    {% for e in timeline %}
        <div class="iaw-event {{ e.source }}">

            <div class="iaw-event-header">
                {{ e.timestamp }}
                —
                <span class="iaw-event-type">{{ e.event_type }}</span>
                {% if e.user %} — {{ e.user }}{% endif %}
                {% if e.unit_id %} ({{ e.unit_id }}){% endif %}
            </div>

            <div class="iaw-event-body">
                {% if e.source == 'photo' and e.filename %}
                    <img src="/static/uploads/photos/{{ e.filename }}" alt="{{ e.text }}"
                         style="max-width:200px; max-height:150px; border-radius:4px; margin-bottom:4px; display:block;">
                {% endif %}
                {% if e.text %}
                    <div>{{ e.text }}</div>
                {% endif %}
            </div>

        </div>
    {% endfor %}

</div>

<style>
.iaw-timeline {
    margin-top: 12px;
    border-top: 1px solid rgba(255,255,255,0.08);
    padding-top: 8px;
    max-height: 400px;
    overflow-y: auto;
}

.iaw-event {
    margin-bottom: 8px;
    padding-left: 10px;
    border-left: 3px solid #2a3a52;
}

.iaw-event.history { border-color: #4da3ff; }
.iaw-event.narrative { border-color: #5bd28c; }
.iaw-event.dailylog { border-color: #f1c453; }
.iaw-event.photo { border-color: #e879f9; }

.iaw-event-header {
    font-size: 12px;
    opacity: 0.75;
    margin-bottom: 2px;
}

.iaw-event-type {
    font-weight: 600;
    text-transform: uppercase;
}

.iaw-event-body {
    font-size: 13px;
    background: rgba(19,32,47,0.7);
    padding: 6px 8px;
    border-radius: 4px;
}

.iaw-empty {
    opacity: 0.6;
    font-style: italic;
}
</style>
