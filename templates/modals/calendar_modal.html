<!-- Calendar Modal -->
<div class="cad-modal-overlay" onclick="CAD_MODAL.close()"></div>
<div class="cad-modal calendar-modal" role="dialog" aria-modal="true" aria-label="Calendar">
    <div class="cad-modal-header">
        <div class="cad-modal-title">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
            Calendar â€” {{ current_month }}
        </div>
        <button class="cad-modal-close" onclick="CAD_MODAL.close()">&times;</button>
    </div>
    <div class="cad-modal-body">
        <div class="calendar-container">
            <div class="calendar-nav">
                <button class="btn-secondary" onclick="CALENDAR.prevMonth()">&larr; Prev</button>
                <span class="calendar-month-title">{{ current_month }}</span>
                <button class="btn-secondary" onclick="CALENDAR.nextMonth()">Next &rarr;</button>
            </div>
            <div class="calendar-grid">
                <div class="calendar-header">
                    <span>Sun</span><span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span>
                </div>
                <div id="calendar-days" class="calendar-days">
                    <!-- Days populated by JS -->
                </div>
            </div>
            <div class="calendar-legend">
                <span class="legend-item"><span class="dot shift-a"></span> A Shift</span>
                <span class="legend-item"><span class="dot shift-b"></span> B Shift</span>
                <span class="legend-item"><span class="dot shift-c"></span> C Shift</span>
            </div>
        </div>
    </div>
    <div class="cad-modal-footer">
        <button class="btn-secondary" onclick="CAD_MODAL.close()">Close</button>
    </div>
</div>

<style>
.calendar-modal { min-width: 500px; }
.calendar-container { padding: var(--space-2); }
.calendar-nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-3);
}
.calendar-month-title {
    font-size: var(--text-lg);
    font-weight: 700;
}
.calendar-grid { margin-bottom: var(--space-3); }
.calendar-header {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    text-align: center;
    font-weight: 600;
    font-size: var(--text-sm);
    padding: var(--space-2) 0;
    border-bottom: 1px solid var(--border-default);
}
.calendar-days {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 2px;
}
.calendar-day {
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-sm);
    border-radius: var(--radius-sm);
    cursor: pointer;
}
.calendar-day:hover { background: var(--bg-hover); }
.calendar-day.today {
    background: var(--ford-blue);
    color: white;
    font-weight: 700;
}
.calendar-day.other-month { color: var(--text-muted); }
.calendar-legend {
    display: flex;
    gap: var(--space-4);
    font-size: var(--text-sm);
}
.legend-item { display: flex; align-items: center; gap: var(--space-1); }
.dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}
.dot.shift-a { background: #ef4444; }
.dot.shift-b { background: #3b82f6; }
.dot.shift-c { background: #22c55e; }
</style>

<script>
window.CALENDAR = {
    currentDate: new Date(),

    render() {
        const container = document.getElementById('calendar-days');
        if (!container) return;

        const year = this.currentDate.getFullYear();
        const month = this.currentDate.getMonth();
        const today = new Date();

        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const startPad = firstDay.getDay();

        let html = '';

        // Previous month padding
        const prevMonth = new Date(year, month, 0);
        for (let i = startPad - 1; i >= 0; i--) {
            html += `<div class="calendar-day other-month">${prevMonth.getDate() - i}</div>`;
        }

        // Current month days
        for (let d = 1; d <= lastDay.getDate(); d++) {
            const isToday = (d === today.getDate() && month === today.getMonth() && year === today.getFullYear());
            html += `<div class="calendar-day${isToday ? ' today' : ''}">${d}</div>`;
        }

        // Next month padding
        const remaining = 42 - (startPad + lastDay.getDate());
        for (let i = 1; i <= remaining; i++) {
            html += `<div class="calendar-day other-month">${i}</div>`;
        }

        container.innerHTML = html;
    },

    prevMonth() {
        this.currentDate.setMonth(this.currentDate.getMonth() - 1);
        this.render();
        this.updateTitle();
    },

    nextMonth() {
        this.currentDate.setMonth(this.currentDate.getMonth() + 1);
        this.render();
        this.updateTitle();
    },

    updateTitle() {
        const title = document.querySelector('.calendar-month-title');
        if (title) {
            title.textContent = this.currentDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
        }
    }
};

// Initialize on load
CALENDAR.render();
</script>
