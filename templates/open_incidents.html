<div id="panel-open"
     class="incident-subpanel open-incidents"
     hx-get="/panel/open"
     hx-trigger="incident-updated from:body, cad:refresh-panels from:document"
     hx-target="#panel-open"
     hx-swap="outerHTML">

    <div class="incident-panel-header">
        <div class="incident-panel-title">Open Incidents</div>
        <div class="incident-panel-meta">
            <span class="panel-badge">{{ incidents|length }}</span>
        </div>
    </div>

    <div class="incident-content">
    {% if incidents|length == 0 %}
        <div class="incident-empty">No open incidents</div>
    {% else %}
        <table class="incident-table">
            <thead>
                <tr>
                    <th class="col-num">#</th>
                    <th class="col-issue"></th>
                    <th class="col-id">ID</th>
                    <th class="col-type">Type</th>
                    <th class="col-location">Location</th>
                    <th class="col-age">Age</th>
                </tr>
            </thead>
            <tbody>
                {% for i in incidents %}
                <tr class="incident-row"
                    tabindex="0"
                    data-incident-id="{{ i.incident_id }}"
                    data-status="{{ i.status or 'OPEN' }}"
                    data-row-num="o{{ loop.index }}"
                    onclick="IAW.open({{ i.incident_id }})"
                    oncontextmenu="CAD_CONTEXTMENU.showForIncident(event, {{ i.incident_id }}, this)">
                    <td class="row-num open-num">o{{ loop.index }}</td>
                    <td class="issue-flag">{% if i.issue_flag %}<span class="issue-indicator" title="Issue reported">!</span>{% endif %}</td>
                    <td class="incident-id">{{ i.incident_number or 'NO#' }}</td>
                    <td class="incident-type">
                        <div class="inc-type-line">
                            <span class="inc-type">{{ i.type }}</span>
                            <span class="inc-pill" data-status="{{ (i.status or '')|upper }}">{{ i.status }}</span>
                        </div>
                    </td>
                    <td class="incident-location" title="{{ i.location }}">{{ i.location }}</td>
                    <td class="incident-age" data-timestamp="{{ i.created }}">{{ i.age or '' }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}
    </div>

</div>
